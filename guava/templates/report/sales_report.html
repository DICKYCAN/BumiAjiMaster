{% extends "base/base.html" %}

{% block content %}

<h1>Sales Report</h1>

<br>
<form class="form-sample" action="" method="get">
    <div class="form-row">
        <div class="form-group col-md-4">
            <label class="col-form-label">Start Date</label>
            <input class="form-control input-short" type="date" value="{{start}}" name="start">
        </div>
        <div class="form-group col-md-4">
            <label class="col-form-label">End Date</label>
            <input class="form-control input-short" type="date" value="{{end}}" name="end">
        </div>
        <div class="form-group col-md-4 align-self-end">
            <button type="submit" class="btn btn-success btn-icon-text">
                <i class="mdi mdi-file-check btn-icon-prepend"></i> Submit</button>
        </div>
    </div>
</form>

{% if detail_sales_list %}
<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>No</th>
                                <th>Sales ID</th>
                                <th>Market ID</th>
                                <th>Date</th>
                                <th>Commodity Name</th>
                                <th>Commodity Price</th>
                                <th>Commodity Amount</th>
                                <th>Product Name</th>
                                <th>Product Price</th>
                                <th>Product Amount</th>
                                <th>Subtotal</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        {% for item in detail_sales_list %}
                        <tbody class="table-dark">
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{item.0.sale_id}}</td>
                                <td>{{item.0.market_id}}</td>
                                <td>{{item.0.date}}</td>
                                <td>
                                    {% for detail in item.1 %}
                                        {% if detail.commodity_id %}
                                            <h6>{{detail.commodity_id.commodity_name}}</h6>
                                        {% else %}
                                            <h6>-</h6>
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.1 %}
                                        {% if detail.commodity_id.purchase_price == None %}
                                        <h6>-</h6>
                                        {% else %}
                                        <h6>Rp{{detail.commodity_id.purchase_price}}</h6>
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.1 %}
                                        {% if detail.commodity_quantity == None %}
                                        <h6>-</h6>
                                        {% else %}
                                        <h6>{{detail.commodity_quantity}}</h6>
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.1 %}
                                        {% if detail.product_id == None %}
                                        <h6>-</h6>
                                        {% else %}
                                        <h6>{{detail.product_id}}</h6>
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.1 %}
                                        {% if detail.product_id.product_price == None %}
                                        <h6>-</h6>
                                        {% else %}
                                        <h6>Rp{{detail.product_id.product_price}}</h6>
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.1 %}
                                        <h6>{{detail.product_quantity}}</h6>
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for detail in item.2 %}
                                        <h6>Rp{{detail}}</h6>
                                    {% endfor %}
                                </td>
                                <td>Rp{{item.3}}</td>
                            </tr>
                        </tbody>
                        {% endfor %}
                        <tfoot class="table-dark">
                            <tr class="table-success">
                                <th colspan="11" style="text-align:center;">Grand Total</th>
                                <th>Rp{{grand_total}}</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
