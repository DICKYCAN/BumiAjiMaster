{% extends "base/base.html" %}

{% block content %}


<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
        
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <div class="form-group">
                        <form class="form-inline" method="get">
                           
                                <label for="start" class="col-form-label">Start Date</label>
                                <input class="form-control form-control-sm mb-2 mr-sm-2 ml-2" type="date" value="{{mulai|date:'Y-m-d'}}" name="mulai" id="mulai">
                    
                                <label for="end_date" class="col-form-label">End Date</label>
                                <input class="form-control form-control-sm  mb-2 mr-sm-2 ml-2" type="date"value="{{akhir|date:'Y-m-d'}}" name="akhir" id="akhir">
                    
                                <label for="harvest_type" class="col-form-label">Harvest Type</label>
                                <select class="form-control form-control-sm  mb-2 mr-sm-2 ml-2" name="harvest_type" id="harvest_type">
                                    <option value="partner harvest" {% if harvest_type == "partner harvest" %} selected {% endif %}>partner harvest</option>
                                    <option value="local harvest" {% if harvest_type == "local harvest" %} selected {% endif %}>local harvest</option>
                                </select>
                                <button class="btn btn-primary ml-2 mb-2" type="submit">Submit</button>
                            
                        </form>
                    </div>
                    {% if detail_partner %}
                    <h3 class="card-title">Harvest Report {{harvest_type}}</h3>
                    <table class="table table-bordered" id="laporanmitra">
                        <thead class="table-light">
                            <tr>
                                <td>No</td>
                                <td>Date</td>
                                <td>Partner Name</td>
                                <td>Commodity Name</td>
                                <td>Purchase Price</td>
                                <td>Commodity Amount</td>
                                <td>Exoiry Date</td>
                                <td>Subtotal</td>
                                <td>Total</td>
                            </tr>
                        </thead>
                        <tbody class="table-dark">
                            {% for item in detail_partner %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{item.0.harvest_date}}</td>
                                <td>{{item.0.partner_id}}</td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li >{{detail.commodity_id}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">Rp{{detail.commodity_id.purchase_price}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.quantity}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.expiry_date}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.2 %}
                                            <li class="mb-2">Rp{{detail}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>Rp{{item.3}}</td>
                        
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tr>
                            <th colspan="8"  style="text-align:center;">Grand Total</th>
                            <td><b>Rp{{grandtotal}}</b></td>
                        </tr>
                    </table>
                    {% elif detail_local %}
                    <h1 class="card-title">Harvest Report {{harvest_type}}</h1>
                    <table class="table table-bordered" id="laporanlokal">
                        <thead class="table-light">
                            <tr>
                                <td>No</td>
                                <td>Date</td>
                                <td>Commodity Name</td>
                                <td>Purchase Price</td>
                                <td>Commodity Amount</td>
                                <td>Exoiry Date</td>
                                <td>Subtotal</td>
                                <td>Total</td>
                            </tr>
                        </thead>
                        {% for item in detail_local %}
                        <tbody class="table-dark">
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{item.0.harvest_date}}</td>
                                <td>
                                    <ul class="mt-2">
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.commodity_id}}</li>
                                        {% endfor %}
                                        
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">Rp{{detail.commodity_id.purchase_price}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.quantity}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.expiry_date}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>

                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.2 %}
                                            <li class="mb-2">Rp{{detail}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>Rp{{item.3}}</td>
                        
                            </tr>
                        </tbody>
                        {% endfor %}
                        <tr >
                            <th colspan="7"  style="text-align:center;">Grand Total</th>
                            <td><b>Rp{{grand_total_local}}</b></td>
                        </tr>
                    </table>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
</div>

{% endblock %}
